<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>JavaScriptç¬”è®°ï¼šè¿­ä»£å™¨å’Œç”Ÿæˆå™¨ | Hooyu&#39;s Note</title>
<meta name="description" content="ğŸ—»æç¯ç…§èƒ†çœ‹æ±Ÿå±±">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://blog.ikozn.com//favicon.ico?v=1621318823086">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://blog.ikozn.com//styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />



  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://blog.ikozn.com/">
        <img src="https://blog.ikozn.com//images/avatar.png?v=1621318823086" class="site-logo">
        <h1 class="site-title">Hooyu&#39;s Note</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
        
          <a href="https://www.notion.so/ikozn/BookList-3cfeb2523e8b49f18da9e425b5502984" class="site-nav" target="_blank">
            ä¹¦å•
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      ğŸ—»æç¯ç…§èƒ†çœ‹æ±Ÿå±±
    </div>
    <div class="site-footer">
      æ€•ä»€ä¹ˆçœŸç†æ— ç©·ï¼Œè¿›ä¸€å¯¸æœ‰ä¸€å¯¸çš„æ¬¢å–œ | <a class="rss" href="https://blog.ikozn.com//atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">JavaScriptç¬”è®°ï¼šè¿­ä»£å™¨å’Œç”Ÿæˆå™¨</h2>
            <div class="post-date">2021-05-16</div>
            
            <div class="post-content">
              <h1 id="å‰è¨€">å‰è¨€</h1>
<blockquote>
<p>ç»™å¤ä¹ æ—¶çš„è‡ªå·±çœ‹ï¼Œå¿«é€Ÿå›é¡¾</p>
</blockquote>
<h2 id="è¿­ä»£å™¨å¿«é€Ÿå›é¡¾">è¿­ä»£å™¨å¿«é€Ÿå›é¡¾</h2>
<ol>
<li>
<p>è¿­ä»£å™¨æ˜¯ä¸€ä¸ªå¯ä»¥ç”±ä»»æ„å¯¹è±¡å®ç°çš„æ¥å£ï¼Œæ”¯æŒè¿ç»­è·å–å¯¹è±¡äº§å‡ºçš„æ¯ä¸€ä¸ªå€¼ã€‚</p>
</li>
<li>
<p>ä»»ä½•å®ç°<code>Iterable</code>æ¥å£çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>Symbol.iterator</code>å±æ€§ï¼Œè¿™ä¸ªå±æ€§å¼•ç”¨é»˜è®¤è¿­ä»£å™¨ã€‚</p>
</li>
<li>
<p>é»˜è®¤è¿­ä»£å™¨å°±åƒä¸€ä¸ªè¿­ä»£å™¨å·¥å‚ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨ä¹‹åä¼šäº§ç”Ÿä¸€ä¸ªå®ç°<code>Iterator</code>æ¥å£çš„å¯¹è±¡</p>
<p>è¿™ä¸ªæ¥å£å¯ä»¥é€šè¿‡æ‰‹åŠ¨åå¤è°ƒç”¨<code>next()</code>æ–¹æ³•æ¥æ¶ˆè´¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åŸç”Ÿæ¶ˆè´¹è€…ï¼Œæ¯”å¦‚<code>for-of</code>å¾ªç¯æ¥è‡ªåŠ¨æ¶ˆè´¹ã€‚</p>
</li>
<li>
<p>è¿­ä»£å™¨å¿…é¡»é€šè¿‡è¿ç»­è°ƒç”¨<code>next()</code>æ–¹æ³•æ‰èƒ½è¿ç»­å–å¾—å€¼ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª<code>IteratorObject</code>ã€‚</p>
</li>
<li>
<p>è¿™ä¸ªå¯¹è±¡åŒ…å«ä¸€ä¸ª<code>done</code>å±æ€§å’Œä¸€ä¸ª<code>value</code>å±æ€§ã€‚</p>
<p>å‰è€…æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è¿˜æœ‰æ›´å¤šå€¼å¯ä»¥è®¿é—®ï¼Œåè€…åŒ…å«è¿­ä»£å™¨è¿”å›çš„å½“å‰å€¼</p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">æ¦‚å¿µ</th>
<th style="text-align:left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">è¿­ä»£å™¨æ¨¡å¼</td>
<td style="text-align:left">åˆ†ç¦»åˆ†ç¦»<code>Iterable</code>ï¼ˆå¯è¿­ä»£å¯¹è±¡ï¼‰å’Œ<code>Iterator</code>ï¼ˆè¿­ä»£å™¨ï¼‰ï¼Œçš„ä¸€ç§æ¨¡å¼ã€‚<br />è¿­ä»£å™¨æ— é¡»äº†è§£ä¸å…¶å…³è”çš„å¯è¿­ä»£å¯¹è±¡çš„ç»“æ„ï¼Œåªéœ€è¦çŸ¥é“å¦‚ä½•å–å¾—è¿ç»­çš„å€¼ï¼ˆä¸‹ä¸€ä¸ªå€¼ï¼‰</td>
</tr>
<tr>
<td style="text-align:center">è¿­ä»£åè®®</td>
<td style="text-align:left">åˆ†ä¸º<strong>å¯è¿­ä»£åè®®</strong>å’Œ<strong>è¿­ä»£å™¨åè®®</strong>ï¼Œä¸€ç§çº¦å®šï¼Œä»»ä½•å¯¹è±¡åªè¦éµå¾ªçº¦å®šå°±å¯ä»¥å®ç°</td>
</tr>
<tr>
<td style="text-align:center">å¯è¿­ä»£å¯¹è±¡</td>
<td style="text-align:left">æœ‰<code>[Symbol.iterator]()</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œå½“ç„¶è¿™ä¸ªæ–¹æ³•è¦éµå¾ªçº¦å®š</td>
</tr>
<tr>
<td style="text-align:center">Iterable æ¥å£</td>
<td style="text-align:left">å°±æ˜¯å¯¹è±¡ä¸Šçš„<code>[Symbol.iterator]()</code>æ–¹æ³•</td>
</tr>
<tr>
<td style="text-align:center">Iterrator</td>
<td style="text-align:left">è¿­ä»£å™¨ï¼Œç”±<code>[Symbol.iterator]()</code>æ–¹æ³•ç”Ÿäº§å‡ºæ¥çš„å¯¹è±¡ï¼Œæœ‰<code>next()</code>æ–¹æ³•<br />è°ƒç”¨è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡é‡Œæœ‰å½“å‰è¿­ä»£å™¨çš„çŠ¶æ€å’Œè·å–åˆ°çš„å€¼</td>
</tr>
</tbody>
</table>
<p><strong>è‡ªå®šä¹‰è¿­ä»£å™¨ï¼š</strong></p>
<pre><code class="language-js">class Counter {
  constructor(limit) {
    this.limit = limit;
  }

  // -  Iterable æ¥å£
  [Symbol.iterator]() {
    let count = 1,
        limit = this.limit;

    // - è¿”å› Iteratorï¼ˆè¿­ä»£å™¨ï¼‰
    return {
      next() {
        if (count &lt;= limit) {
          // - è¿”å› IteratorResult å¯¹è±¡ 
          return { done: false, value: count++ };
        } else {
          // - è¿”å› IteratorResult å¯¹è±¡ 
          return { done: true, value: undefined };
        }
      },
      // - Iteratorï¼ˆè¿­ä»£å™¨ï¼‰ è¿”å› è¿­ä»£å™¨æœ¬èº«
      [Symbol.iterator]() {
          return this
      }
    };
  }
}

let counter = new Counter(3);

for (let i of counter) { console.log(i); }
// 1
// 2
// 3

for (let i of counter) { console.log(i); }
// 1
// 2
// 3

let iter1 = counter[Symbol.iterator]();
let iter2 = iter1[Symbol.iterator]();
console.log(iter1 === iter2);         // true
</code></pre>
<p><strong>æ¥æ”¶å¯è¿­ä»£å¯¹è±¡çš„åŸç”Ÿè¯­è¨€ç‰¹æ€§ï¼š</strong></p>
<ul>
<li><code>for-of</code>å¾ªç¯</li>
<li>æ•°ç»„è§£æ„</li>
<li>æ‰©å±•æ“ä½œç¬¦</li>
<li><code>Array.from()</code></li>
<li>åˆ›å»ºé›†åˆ</li>
<li>åˆ›å»ºæ˜ å°„</li>
<li><code>Promise.all()</code>æ¥æ”¶ç”±æœŸçº¦ç»„æˆçš„å¯è¿­ä»£å¯¹è±¡</li>
<li><code>Promise.race()</code>æ¥æ”¶ç”±æœŸçº¦ç»„æˆçš„å¯è¿­ä»£å¯¹è±¡</li>
<li><code>yield*</code>æ“ä½œç¬¦ï¼Œåœ¨ç”Ÿæˆå™¨ä¸­ä½¿ç”¨</li>
</ul>
<p>è¿™äº›åŸç”Ÿè¯­è¨€ç»“æ„ä¼šåœ¨åå°è°ƒç”¨æä¾›çš„å¯è¿­ä»£å¯¹è±¡çš„è¿™ä¸ªå·¥å‚å‡½æ•°ï¼ˆä¹Ÿå°±æ˜¯<code>Symbol.iterator</code>ï¼‰ï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼š</p>
<pre><code class="language-js">let arr = ['foo', 'bar', 'baz'];

// for-ofå¾ªç¯
for (let el of arr) {
  console.log(el);
}
// foo
// bar
// baz

// æ•°ç»„è§£æ„
let [a, b, c] = arr;
console.log(a, b, c); // foo, bar, baz

// æ‰©å±•æ“ä½œç¬¦
let arr2 = [...arr];
console.log(arr2); // ['foo', 'bar', 'baz']

// Array.from()
let arr3 = Array.from(arr);
console.log(arr3); // ['foo', 'bar', 'baz']

// Setæ„é€ å‡½æ•°
let set = new Set(arr);
console.log(set); // Set(3) {'foo', 'bar', 'baz'}

// Mapæ„é€ å‡½æ•°
let pairs = arr.map((x, i) =&gt; [x, i]);
console.log(pairs); // [['foo', 0], ['bar', 1], ['baz', 2]]
let map = new Map(pairs);
console.log(map); // Map(3) { 'foo'=&gt;0, 'bar'=&gt;1, 'baz'=&gt;2 }
</code></pre>
<h2 id="ç”Ÿæˆå™¨å¿«é€Ÿå›é¡¾">ç”Ÿæˆå™¨å¿«é€Ÿå›é¡¾</h2>
<ol>
<li>
<p>ç”Ÿæˆå™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ï¼Œè°ƒç”¨ä¹‹åä¼šè¿”å›ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ã€‚</p>
</li>
<li>
<p>ç”Ÿæˆå™¨å¯¹è±¡å®ç°äº†<code>Iterable</code>æ¥å£ï¼Œå› æ­¤å¯ç”¨åœ¨ä»»ä½•æ¶ˆè´¹å¯è¿­ä»£å¯¹è±¡çš„åœ°æ–¹ã€‚</p>
</li>
<li>
<p>ç”Ÿæˆå™¨çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºæ”¯æŒ<code>yield</code>å…³é”®å­—ï¼Œè¿™ä¸ªå…³é”®å­—èƒ½å¤Ÿæš‚åœæ‰§è¡Œç”Ÿæˆå™¨å‡½æ•°</p>
</li>
<li>
<p>ä½¿ç”¨<code>yield</code>å…³é”®å­—è¿˜å¯ä»¥é€šè¿‡<code>next()</code>æ–¹æ³•æ¥æ”¶è¾“å…¥å’Œäº§ç”Ÿè¾“å‡ºã€‚</p>
</li>
<li>
<p>åœ¨åŠ ä¸Šæ˜Ÿå·ä¹‹åï¼Œ<code>yield</code>å…³é”®å­—å¯ä»¥å°†è·Ÿåœ¨å®ƒåé¢çš„å¯è¿­ä»£å¯¹è±¡åºåˆ—åŒ–ä¸ºä¸€è¿ä¸²å€¼ï¼ˆè®©æƒæ‰§è¡Œå¦ä¸€ä¸ªè¿­ä»£å™¨ï¼‰ã€‚</p>
</li>
</ol>
<p><strong>è¡¨ç°å½¢å¼ï¼š</strong></p>
<pre><code class="language-js">function* generatorFn() {
  yield 1;
  yield 2;
  yield 3;
}

for (const x of generatorFn()) {
  console.log(x);
}
// 1
// 2
// 3
</code></pre>
<h1 id="è¿­ä»£å™¨">è¿­ä»£å™¨</h1>
<h2 id="what">What</h2>
<h3 id="è¿­ä»£å™¨æ¨¡å¼å’Œè¿­ä»£åè®®æ˜¯ä»€ä¹ˆ">è¿­ä»£å™¨æ¨¡å¼å’Œè¿­ä»£åè®®æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li>
<p>è¿­ä»£å™¨æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><strong>è¿­ä»£å™¨æ¨¡å¼</strong>æ˜¯GoFè®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç§è¡Œä¸ºå‹æ¨¡å¼ï¼Œæä¾›ä¸€ä¸ªå¯¹è±¡æ¥é¡ºåºè®¿é—®èšåˆå¯¹è±¡ä¸­çš„ä¸€ç³»åˆ—æ•°æ®ï¼Œè€Œä¸æš´éœ²èšåˆå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p>
<p>åœ¨è¿™é‡Œï¼ˆECMAScriptï¼‰çš„å…·ä½“è¡¨ç°ä¸ºåˆ†ç¦»<code>Iterable</code>ï¼ˆå¯è¿­ä»£å¯¹è±¡ï¼‰å’Œ<code>Iterator</code>ï¼ˆè¿­ä»£å™¨ï¼‰</p>
<p>è¿­ä»£å™¨æ— é¡»äº†è§£ä¸å…¶å…³è”çš„å¯è¿­ä»£å¯¹è±¡çš„ç»“æ„ï¼Œåªéœ€è¦çŸ¥é“å¦‚ä½•å–å¾—è¿ç»­çš„å€¼ï¼ˆä¸‹ä¸€ä¸ªå€¼ï¼‰</p>
</li>
<li>
<p>è¿­ä»£åè®®æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>ECMAScript 2015 çš„ä¸€ç»„è¡¥å……è§„èŒƒï¼Œè¿­ä»£åè®®å¹¶ä¸æ˜¯æ–°çš„å†…ç½®å®ç°æˆ–è¯­æ³•ï¼Œè€Œæ˜¯<em>åè®®</em>ã€‚è¿™äº›åè®®å¯ä»¥è¢«ä»»ä½•éµå¾ªæŸäº›çº¦å®šçš„å¯¹è±¡æ¥å®ç°ã€‚</p>
<p>è¿­ä»£åè®®å…·ä½“åˆ†ä¸ºä¸¤ä¸ªåè®®ï¼š[å¯è¿­ä»£åè®®](#å¯è¿­ä»£åè®® ä¸ Iterable æ¥å£ æ˜¯ä»€ä¹ˆï¼Ÿ)å’Œ[è¿­ä»£å™¨åè®®](#è¿­ä»£å™¨åè®® ä¸ Iterator  æ˜¯ä»€ä¹ˆï¼Ÿ)ã€‚</p>
</li>
</ol>
<h3 id="å¯è¿­ä»£å¯¹è±¡iterable-æ˜¯ä»€ä¹ˆ">å¯è¿­ä»£å¯¹è±¡/iterable æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>æŠŠæ»¡è¶³<strong>ç‰¹å®šæ¡ä»¶</strong>çš„ç»“æ„ç§°ä¸º**â€œå¯è¿­ä»£å¯¹è±¡â€ï¼ˆiterableï¼‰**ï¼Œä¾‹å¦‚æ•°ç»„æˆ–é›†åˆè¿™æ ·çš„é›†åˆç±»å‹çš„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯è‡ªå®šä¹‰çš„å¯¹è±¡ã€‚</p>
<pre><code class="language-js">// æ•°ç»„çš„å…ƒç´ æ˜¯æœ‰é™çš„
// é€’å¢ç´¢å¼•å¯ä»¥æŒ‰åºè®¿é—®æ¯ä¸ªå…ƒç´ 
let arr = [3, 1, 4];

// é›†åˆçš„å…ƒç´ æ˜¯æœ‰é™çš„
// å¯ä»¥æŒ‰æ’å…¥é¡ºåºè®¿é—®æ¯ä¸ªå…ƒç´ 
let set = new Set().add(3).add(1).add(4);
</code></pre>
<p>ç‰¹å®šçš„æ¡ä»¶æœ‰ä¸¤ä¸ªï¼š</p>
<ol>
<li>å®ç°äº†æ­£å¼çš„[Iterableæ¥å£](#å¯è¿­ä»£åè®® ä¸ Iterable æ¥å£ æ˜¯ä»€ä¹ˆï¼Ÿ)</li>
<li>å®ç°çš„<code>Iterable</code>æ¥å£å¯ä»¥é€šè¿‡è¿­ä»£å™¨<code>Iterator</code>è¿­ä»£</li>
</ol>
<h3 id="å¯è¿­ä»£åè®®-ä¸-iterable-æ¥å£-æ˜¯ä»€ä¹ˆ">å¯è¿­ä»£åè®® ä¸ Iterable æ¥å£ æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li>
<p>å¯è¿­ä»£åè®®æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>å¯è¿­ä»£åè®®å¹¶ä¸æ˜¯æ–°çš„å†…ç½®å®ç°æˆ–è¯­æ³•ï¼Œè€Œæ˜¯***åè®®***ï¼Œè¿™ä¸ªåè®®å¯ä»¥è¢«ä»»ä½•éµå¾ªæŸäº›çº¦å®šçš„å¯¹è±¡æ¥å®ç°ï¼Œå½“æŸä¸ªå¯¹è±¡å®ç°äº†<code>Iterable</code>æ¥å£å¯ä»¥è§†ä¸ºå®ç°äº†å¯è¿­ä»£åè®®ã€‚</p>
</li>
<li>
<p><code>Iterable</code>æ¥å£æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><code>Iterable</code>æ¥å£æŒ‡çš„æ˜¯å¯¹è±¡ä¸Šä½¿ç”¨<code>Symbol.iterator</code>ä½œä¸ºé”®çš„ä¸€ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªè¿­ä»£å™¨å·¥å‚å‡½æ•°ï¼Œè°ƒç”¨è¿™ä¸ªå·¥å‚å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªæ–°[è¿­ä»£å™¨](#è¿­ä»£å™¨åè®® ä¸ Iterator  æ˜¯ä»€ä¹ˆï¼Ÿ)</p>
<table>
<thead>
<tr>
<th style="text-align:left">å±æ€§</th>
<th style="text-align:left">å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>[Symbol.iterator]</code></td>
<td style="text-align:left">ä¸€ä¸ªæ— å‚æ•°çš„å‡½æ•°ï¼Œå…¶è¿”å›å€¼ä¸ºä¸€ä¸ªç¬¦åˆ[è¿­ä»£å™¨åè®®](#è¿­ä»£å™¨åè®® ä¸ Iterator  æ˜¯ä»€ä¹ˆï¼Ÿ)çš„å¯¹è±¡</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h3 id="è¿­ä»£å™¨åè®®-ä¸-iteratorè¿­ä»£å™¨-æ˜¯ä»€ä¹ˆ">è¿­ä»£å™¨åè®® ä¸ Iteratorï¼ˆè¿­ä»£å™¨ï¼‰  æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li>
<p><strong>è¿­ä»£å™¨åè®® æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p><strong>è¿­ä»£å™¨åè®®</strong>å®šä¹‰äº†äº§ç”Ÿä¸€ç³»åˆ—å€¼ï¼ˆæ— è®ºæ˜¯æœ‰é™ä¸ªè¿˜æ˜¯æ— é™ä¸ªï¼‰çš„æ ‡å‡†æ–¹å¼ã€‚å½“å€¼ä¸ºæœ‰é™ä¸ªæ—¶ï¼Œæ‰€æœ‰çš„å€¼éƒ½è¢«è¿­ä»£å®Œæ¯•åï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªé»˜è®¤è¿”å›å€¼ã€‚</p>
<p><strong>å®ç°äº†<code>Iterator</code>å°±ç›¸å½“äºå®ç°äº†è¿­ä»£å™¨åè®®ã€‚</strong></p>
</li>
<li>
<p><strong>Iteratorï¼ˆè¿­ä»£å™¨ï¼‰ æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>å…¶å®å°±æ˜¯æŒ‡ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«ç€<code>next()</code>å’Œ<code>return()</code>ï¼ˆå¯é€‰ï¼‰ä¸¤ä¸ªæ–¹æ³•ã€‚<br>
è°ƒç”¨<code>Iterable</code>ï¼ˆå¯è¿­ä»£åè®®æ¥å£ï¼‰è¿”å›<code>Iterator</code>ï¼ˆè¿­ä»£å™¨ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ä¸€æ¬¡æ€§ä½¿ç”¨çš„å¯¹è±¡ï¼Œç”¨äºè¿­ä»£ï¼Œå…¶ä¸Šæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">å±æ€§</th>
<th style="text-align:left">å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>next()</code></td>
<td style="text-align:left">æ¯æ¬¡æˆåŠŸè°ƒç”¨éƒ½ä¼šè¿”å›ä¸€ä¸ª<code>IteratorResult</code>å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«è¿­ä»£å™¨è¿”å›çš„ä¸‹ä¸€ä¸ªå€¼</td>
</tr>
<tr>
<td style="text-align:left"><code>return()</code></td>
<td style="text-align:left">å¯é€‰çš„æ–¹æ³•ï¼Œç”¨äºæŒ‡å®šåœ¨è¿­ä»£å™¨æå‰å…³é—­æ—¶æ‰§è¡Œçš„é€»è¾‘ï¼Œåœ¨[ä¸‹é¢](#æå‰ç»ˆæ­¢è¿­ä»£å™¨ä¸return() åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ)æœ‰è¯¦ç»†ç¬”è®°</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h3 id="iteratorresultå¯¹è±¡-æ˜¯ä»€ä¹ˆ"><code>IteratorResult</code>å¯¹è±¡ æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">å±æ€§</th>
<th style="text-align:left">å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>done</code></td>
<td style="text-align:left">ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è¿˜å¯ä»¥å†æ¬¡è°ƒç”¨<code>next()</code>å–å¾—ä¸‹ä¸€ä¸ªå€¼ï¼›</td>
</tr>
<tr>
<td style="text-align:left"><code>value</code></td>
<td style="text-align:left">åŒ…å«å¯è¿­ä»£å¯¹è±¡çš„ä¸‹ä¸€ä¸ªå€¼ï¼ˆ<code>done</code>ä¸º<code>false</code>ï¼‰<br />æˆ–è€…<code>undefined</code>ï¼ˆ<code>done</code>ä¸º<code>true</code>ï¼‰</td>
</tr>
</tbody>
</table>
<p><strong>ä¾‹å­</strong></p>
<pre><code class="language-js">// å¯è¿­ä»£å¯¹è±¡
let arr = ['foo', 'bar'];

// è¿­ä»£å™¨å·¥å‚å‡½æ•°
console.log(arr[Symbol.iterator]); // f values() { [native code] }

// è¿­ä»£å™¨
let iter = arr[Symbol.iterator]();
console.log(iter); // ArrayIterator {}

// æ‰§è¡Œè¿­ä»£
console.log(iter.next()); // { done: false, value: 'foo' }
console.log(iter.next()); // { done: false, value: 'bar' }
console.log(iter.next()); // { done: true, value: undefined }
</code></pre>
<h3 id="æå‰ç»ˆæ­¢è¿­ä»£å™¨ä¸return-åˆ†åˆ«æ˜¯ä»€ä¹ˆ">æå‰ç»ˆæ­¢è¿­ä»£å™¨ä¸return() åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li>
<p>æå‰ç»ˆæ­¢è¿­ä»£å™¨æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>è®²çš„æ˜¯å½“è¿­ä»£å™¨è¿˜èƒ½ç»§ç»­è¿­ä»£ä½†æ˜¯éœ€è¦æå‰é€€å‡ºè¿­ä»£çš„ä¸€ç§æƒ…å†µ</p>
<p>æ‰§è¡Œè¿­ä»£çš„ç»“æ„åœ¨æƒ³è®©è¿­ä»£å™¨çŸ¥é“å®ƒä¸æƒ³éå†åˆ°å¯è¿­ä»£å¯¹è±¡è€—å°½æ—¶ï¼Œå°±å¯ä»¥â€œå…³é—­â€è¿­ä»£å™¨</p>
<p>å¯èƒ½çš„æƒ…å†µåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>for-of</code>å¾ªç¯é€šè¿‡<code>break</code>ã€<code>continue</code>ã€<code>return</code>æˆ–<code>throw</code>æå‰é€€å‡º</li>
<li>è§£æ„æ“ä½œæ²¡æœ‰ç”¨åˆ°å…¨éƒ¨çš„å€¼</li>
</ul>
</li>
<li>
<p><code>return()</code>æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><code>Iterator</code>ï¼ˆè¿­ä»£å™¨ï¼‰ä¸Šçš„ä¸€ä¸ªå¯é€‰æ–¹æ³•ï¼Œç”¨äºæŒ‡å®šåœ¨è¿­ä»£å™¨æå‰å…³é—­æ—¶æ‰§è¡Œçš„é€»è¾‘</p>
<p>å†…ç½®è¯­è¨€ç»“æ„åœ¨å‘ç°è¿˜æœ‰æ›´å¤šå€¼å¯ä»¥è¿­ä»£ï¼Œä½†ä¸ä¼šæ¶ˆè´¹è¿™äº›å€¼æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨<code>return()</code>æ–¹æ³•</p>
<p><code>return()</code>æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªæœ‰æ•ˆçš„<code>IteratorResult</code>å¯¹è±¡ï¼Œç®€å•çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åªè¿”å›<code>{ done: true }</code></p>
</li>
</ol>
<p><strong>ä¾‹å­</strong></p>
<pre><code class="language-js">class Counter {
  constructor(limit) {
    this.limit = limit;
  }

  [Symbol.iterator]() {
    let count = 1,
      limit = this.limit;
    return {
      next() {
        if (count &lt;= limit) {
          return { done: false, value: count++ };
        } else {
          return { done: true };
        }
      },
      return() {
        console.log('Exiting early');
        return { done: true };
      }
    };
  }
}


let counter1 = new Counter(5);

for (let i of counter1) {
  if (i &gt; 2) {
    break;
  }
  console.log(i);
}
// 1
// 2
// Exiting early


let counter2 = new Counter(5);

try {
  for (let i of counter2) {
    if (i &gt; 2) {
      throw 'err';
    }
    console.log(i);
  }
} catch(e) {}
// 1
// 2
// Exiting early


let counter3 = new Counter(5);

let [a, b] = counter3;
// Exiting early
</code></pre>
<p><strong>è¡¥å……</strong></p>
<ol>
<li>
<p>å¦‚æœè¿­ä»£å™¨æ²¡æœ‰å…³é—­ï¼Œåˆ™è¿˜å¯ä»¥ç»§ç»­ä»ä¸Šæ¬¡ç¦»å¼€çš„åœ°æ–¹ç»§ç»­è¿­ä»£</p>
</li>
<li>
<p>ä¸æ˜¯æ‰€æœ‰è¿­ä»£å™¨éƒ½æ˜¯å¯å…³é—­çš„ï¼Œä»…ä»…ç»™ä¸€ä¸ªä¸å¯å…³é—­çš„è¿­ä»£å™¨å¢åŠ <code>return()</code>æ–¹æ³•<strong>å¹¶ä¸èƒ½</strong>è®©å®ƒå˜æˆå¯å…³é—­çš„</p>
<p>è¿™æ˜¯å› ä¸ºè°ƒç”¨<code>return()</code>ä¸ä¼šå¼ºåˆ¶è¿­ä»£å™¨è¿›å…¥å…³é—­çŠ¶æ€ï¼Œå³ä¾¿å¦‚æ­¤ï¼Œ<code>return()</code>æ–¹æ³•è¿˜æ˜¯ä¼šè¢«è°ƒç”¨</p>
</li>
</ol>
<p><strong>ä¾‹å­1ï¼š</strong></p>
<pre><code class="language-js">// - ç»§ç»­æ‰§è¡Œæœªå…³é—­çš„è¿­ä»£å™¨
let a = [1, 2, 3, 4, 5];
let iter = a[Symbol.iterator]();

for (let i of iter) {
  console.log(i);
  if (i &gt; 2) {
    break
  }
}
// 1
// 2
// 3

for (let i of iter) {
  console.log(i);
}
// 4
// 5
</code></pre>
<p><strong>ä¾‹å­2ï¼š</strong></p>
<pre><code class="language-js">// - å°è¯•å…³é—­æ•°ç»„çš„è¿­ä»£å™¨ï¼Œå¤±è´¥
let a = [1, 2, 3, 4, 5];
let iter = a[Symbol.iterator]();

iter.return = function() {
  console.log('Exiting early');
  return { done: true };
};

for (let i of iter) {
  console.log(i);
  if (i &gt; 2) {
    break
  }
}
// 1
// 2
// 3
// æå‰é€€å‡º

for (let i of iter) {
  console.log(i);
}
// 4
// 5
</code></pre>
<h3 id="å…¶ä»–">å…¶ä»–</h3>
<ol>
<li>
<p>æ¯ä¸ªè¿­ä»£å™¨éƒ½è¡¨ç¤ºå¯¹å¯è¿­ä»£å¯¹è±¡çš„ä¸€æ¬¡æ€§æœ‰åºéå†</p>
<p>ä¸åŒè¿­ä»£å™¨çš„å®ä¾‹ç›¸äº’ä¹‹é—´æ²¡æœ‰è”ç³»ï¼Œåªä¼šç‹¬ç«‹åœ°éå†å¯è¿­ä»£å¯¹è±¡</p>
<pre><code class="language-js">let arr = ['foo', 'bar'];
let iter1 = arr[Symbol.iterator]();
let iter2 = arr[Symbol.iterator]();

console.log(iter1.next()); // { done: false, value: 'foo' }
console.log(iter2.next()); // { done: false, value: 'foo' }
console.log(iter2.next()); // { done: false, value: 'bar' }
console.log(iter1.next()); // { done: false, value: 'bar' }
</code></pre>
</li>
<li>
<p>å¦‚æœå¯¹è±¡åŸå‹é“¾ä¸Šçš„çˆ¶ç±»å®ç°äº†Iterableæ¥å£ï¼Œé‚£è¿™ä¸ªå¯¹è±¡ä¹Ÿå°±å®ç°äº†è¿™ä¸ªæ¥å£</p>
<pre><code class="language-js">class FooArray extends Array {}
let fooArr = new FooArray('foo', 'bar', 'baz');

for (let el of fooArr) {
  console.log(el);
}
// foo
// bar
// baz
</code></pre>
</li>
</ol>
<h2 id="how">How</h2>
<h3 id="è‡ªå®šä¹‰è¿­ä»£å™¨">è‡ªå®šä¹‰è¿­ä»£å™¨</h3>
<p><strong>è¦ç‚¹ï¼š</strong></p>
<ol>
<li><code>[Symbol.iterator]</code>æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œè¦å®ç°é—­åŒ…</li>
<li><code>iterator</code>ï¼ˆè¿­ä»£å™¨ï¼‰ä¹Ÿè¦å®ç°<code>Iterable</code>ï¼ˆ<code>[Symbol.iterator]</code>ï¼‰æ¥å£</li>
</ol>
<pre><code class="language-js">class Counter {
  constructor(limit) {
    this.limit = limit;
  }

  [Symbol.iterator]() {
    let count = 1,
        limit = this.limit;
      		
    return {
      next() {
        if (count &lt;= limit) {
          return { done: false, value: count++ };
        } else {
          return { done: true, value: undefined };
        }
      },
      [Symbol.iterator]() {
          return this
      }
    };
  }
}

let counter = new Counter(3);

for (let i of counter) { console.log(i); }
// 1
// 2
// 3

for (let i of counter) { console.log(i); }
// 1
// 2
// 3

let iter1 = counter[Symbol.iterator]();
let iter2 = iter1[Symbol.iterator]();
console.log(iter1 === iter2);         // true
</code></pre>
<h3 id="ä¸€äº›å®ç°äº†iterableæ¥å£çš„å†…ç½®ç±»å‹">ä¸€äº›å®ç°äº†<code>Iterable</code>æ¥å£çš„å†…ç½®ç±»å‹</h3>
<ul>
<li>å­—ç¬¦ä¸²</li>
<li>æ•°ç»„</li>
<li>æ˜ å°„</li>
<li>é›†åˆ</li>
<li>TypedArray</li>
<li><code>arguments</code>å¯¹è±¡</li>
<li><code>NodeList</code>ç­‰DOMé›†åˆç±»å‹</li>
</ul>
<h3 id="è¿­ä»£å™¨çš„åº”ç”¨">è¿­ä»£å™¨çš„åº”ç”¨</h3>
<p>éšæœºç‚¹åï¼Œéšæœºè¿­ä»£äººå‘˜ï¼Œè¿­ä»£å®Œåˆ™é‡ç½®ï¼Œç»§ç»­è¿­ä»£</p>
<h1 id="ç”Ÿæˆå™¨">ç”Ÿæˆå™¨</h1>
<h2 id="what-2">What</h2>
<h3 id="ä»€ä¹ˆæ˜¯ç”Ÿæˆå™¨">ä»€ä¹ˆæ˜¯ç”Ÿæˆå™¨ï¼Ÿ</h3>
<ol>
<li>
<p><strong>ç”Ÿæˆå™¨èƒ½åšä»€ä¹ˆï¼Ÿ</strong></p>
<p>æ‹¥æœ‰åœ¨ä¸€ä¸ªå‡½æ•°å—å†…æš‚åœå’Œæ¢å¤ä»£ç æ‰§è¡Œçš„èƒ½åŠ›ï¼Œä½¿ç”¨ç”Ÿæˆå™¨å¯ä»¥è‡ªå®šä¹‰è¿­ä»£å™¨å’Œå®ç°åç¨‹ã€‚</p>
</li>
<li>
<p><strong>æ€ä¹ˆåˆ›å»ºç”Ÿæˆå™¨ï¼Ÿ</strong></p>
<p>ç”Ÿæˆå™¨çš„å½¢å¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°åç§°å‰é¢åŠ ä¸€ä¸ªæ˜Ÿå·ï¼ˆ<code>*</code>ï¼‰è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œå¯ä»¥ç»™ç”Ÿæˆå™¨ä¼ å‚</p>
<p>åªè¦æ˜¯å¯ä»¥å®šä¹‰å‡½æ•°çš„åœ°æ–¹ï¼Œå°±å¯ä»¥å®šä¹‰ç”Ÿæˆå™¨ã€‚</p>
<pre><code class="language-js">// ç”Ÿæˆå™¨å‡½æ•°å£°æ˜
function* generatorFn() {}

// ç”Ÿæˆå™¨å‡½æ•°è¡¨è¾¾å¼
let generatorFn = function* () {}

// ä½œä¸ºå¯¹è±¡å­—é¢é‡æ–¹æ³•çš„ç”Ÿæˆå™¨å‡½æ•°
let foo = {
  * generatorFn() {}
}

// ä½œä¸ºç±»å®ä¾‹æ–¹æ³•çš„ç”Ÿæˆå™¨å‡½æ•°
class Foo {
  * generatorFn() {}
}

// ä½œä¸ºç±»é™æ€æ–¹æ³•çš„ç”Ÿæˆå™¨å‡½æ•°
class Bar {
  static * generatorFn() {}
}
</code></pre>
</li>
<li>
<p><strong>ä»€ä¹ˆæ˜¯ç”Ÿæˆå™¨å¯¹è±¡ï¼Ÿ</strong></p>
<p>è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ä¼šäº§ç”Ÿä¸€ä¸ª<strong>ç”Ÿæˆå™¨å¯¹è±¡</strong>ï¼Œç”Ÿæˆå™¨å¯¹è±¡ä¸€å¼€å§‹å¤„äº**æš‚åœæ‰§è¡Œï¼ˆsuspendedï¼‰**çš„çŠ¶æ€</p>
<p>ç”Ÿæˆå™¨å¯¹è±¡ä¹Ÿå®ç°äº†<code>Iterator</code>æ¥å£ï¼Œå› æ­¤å…·æœ‰<code>next()</code>æ–¹æ³•ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šè®©ç”Ÿæˆå™¨å¼€å§‹æˆ–æ¢å¤æ‰§è¡Œã€‚</p>
</li>
</ol>
<h3 id="yieldå…³é”®å­—æœ‰ä»€ä¹ˆç”¨">yieldå…³é”®å­—æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3>
<p>yieldæ˜¯ç”Ÿæˆå™¨ä¸­æ‰èƒ½ä½¿ç”¨çš„ä¸€ä¸ªå…³é”®å­—ï¼Œæœ‰å››ä¸ªä½œç”¨ï¼š</p>
<ol>
<li>æš‚åœï¼š<code>yield</code>å…³é”®å­—å¯ä»¥è®©ç”Ÿæˆå™¨æš‚åœæ‰§è¡Œ</li>
<li>è¾“å‡ºï¼šé€šè¿‡<code>yield</code>è¿”å›æ•°æ®ï¼ˆè°ƒç”¨<code>next()</code>è¿”å›çš„æ•°æ®ï¼‰</li>
<li>è¾“å…¥ï¼šé€šè¿‡<code>yield</code>è·å–<code>next()</code>ä¼ å…¥çš„æ•°æ®</li>
<li>åºåˆ—åŒ–ï¼šé€šè¿‡<code>yield*</code>å°†å¯è¿­ä»£å¯¹è±¡åºåˆ—åŒ–ä¸ºä¸€è¿ä¸²å€¼</li>
</ol>
<h4 id="æš‚åœè®©ç”Ÿæˆå™¨åœæ­¢æ‰§è¡Œ">æš‚åœï¼šè®©ç”Ÿæˆå™¨åœæ­¢æ‰§è¡Œ</h4>
<blockquote>
<p>yieldè®©ç”Ÿæˆå™¨è¿›å…¥æš‚åœçŠ¶æ€ï¼Œåªèƒ½é€šè¿‡è°ƒç”¨next()æ¢å¤æ‰§è¡Œ</p>
</blockquote>
<p>é€šè¿‡<code>yield</code>å…³é”®å­—é€€å‡ºçš„ç”Ÿæˆå™¨å‡½æ•°ä¼šå¤„åœ¨<code>done: false</code>çŠ¶æ€ï¼›</p>
<p>é€šè¿‡<code>return</code>å…³é”®å­—é€€å‡ºçš„ç”Ÿæˆå™¨å‡½æ•°ä¼šå¤„äº<code>done: true</code>çŠ¶æ€ã€‚</p>
<pre><code class="language-js">function* generatorFn() {
  yield;
}

let generatorObject = generatorFn();

console.log(generatorObject.next());  // { done: false, value: undefined }
console.log(generatorObject.next());  // { done: true, value: undefined }
</code></pre>
<h4 id="è¾“å‡ºé€šè¿‡yieldè¿”å›æ•°æ®">è¾“å‡ºï¼šé€šè¿‡<code>yield</code>è¿”å›æ•°æ®</h4>
<pre><code class="language-js">function* generatorFn() {
  yield 'foo';
  yield 'bar';
  return 'baz';
}

let generatorObject = generatorFn();

console.log(generatorObject.next());  // { done: false, value: 'foo' }
console.log(generatorObject.next());  // { done: false, value: 'bar' }
console.log(generatorObject.next());  // { done: true, value: 'baz' }
</code></pre>
<h4 id="è¾“å…¥ä½œä¸ºå‡½æ•°çš„ä¸­é—´å‚æ•°ä½¿ç”¨">è¾“å…¥ï¼šä½œä¸ºå‡½æ•°çš„ä¸­é—´å‚æ•°ä½¿ç”¨</h4>
<p>ä¸Šä¸€æ¬¡è®©ç”Ÿæˆå™¨å‡½æ•°æš‚åœçš„<code>yield</code>å…³é”®å­—ä¼šæ¥æ”¶åˆ°ä¼ ç»™<code>next()</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå€¼ã€‚è¿™é‡Œæœ‰ä¸ªåœ°æ–¹ä¸å¤ªå¥½ç†è§£â€”â€”ç¬¬ä¸€æ¬¡è°ƒç”¨<code>next()</code>ä¼ å…¥çš„å€¼ä¸ä¼šè¢«ä½¿ç”¨ï¼Œå› ä¸ºè¿™ä¸€æ¬¡è°ƒç”¨æ˜¯ä¸ºäº†å¼€å§‹æ‰§è¡Œç”Ÿæˆå™¨å‡½æ•°ï¼š</p>
<pre><code class="language-js">function* generatorFn(initial) {
  console.log(initial);
  console.log(yield);
  console.log(yield);
}

let generatorObject = generatorFn('foo');

generatorObject.next('bar');  // foo
generatorObject.next('baz');  // baz
generatorObject.next('qux');  // qu
</code></pre>
<h4 id="åºåˆ—åŒ–é€šè¿‡yieldå°†å¯è¿­ä»£å¯¹è±¡åºåˆ—åŒ–ä¸ºä¸€è¿ä¸²å€¼">åºåˆ—åŒ–ï¼šé€šè¿‡<code>yield*</code>å°†å¯è¿­ä»£å¯¹è±¡åºåˆ—åŒ–ä¸ºä¸€è¿ä¸²å€¼</h4>
<pre><code class="language-js">// ç­‰ä»·çš„generatorFnï¼š
// function* generatorFn() {
//   for (const x of [1, 2, 3]) {
//     yield x;
//   }
// }
function* generatorFn() {
  yield* [1, 2, 3];
}

let generatorObject = generatorFn();

for (const x of generatorFn()) {
  console.log(x);
}
// 1
// 2
// 3
</code></pre>
<p>ä¸ç”Ÿæˆå™¨å‡½æ•°çš„æ˜Ÿå·ç±»ä¼¼ï¼Œ<code>yield</code>æ˜Ÿå·ä¸¤ä¾§çš„ç©ºæ ¼ä¸å½±å“å…¶è¡Œä¸ºï¼š</p>
<pre><code class="language-js">function* generatorFn() {
  yield* [1, 2];
  yield *[3, 4];
  yield * [5, 6];
}

for (const x of generatorFn()) {
  console.log(x);
}
// 1
// 2
// 3
// 4
// 5
// 6
</code></pre>
<p>å› ä¸º<code>yield*</code>å®é™…ä¸Šåªæ˜¯å°†ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡åºåˆ—åŒ–ä¸ºä¸€è¿ä¸²å¯ä»¥å•ç‹¬äº§å‡ºçš„å€¼ï¼Œæ‰€ä»¥è¿™è·ŸæŠŠ<code>yield</code>æ”¾åˆ°ä¸€ä¸ªå¾ªç¯é‡Œæ²¡ä»€ä¹ˆä¸åŒã€‚ä¸‹é¢ä¸¤ä¸ªç”Ÿæˆå™¨å‡½æ•°çš„è¡Œä¸ºæ˜¯ç­‰ä»·çš„ï¼š</p>
<pre><code class="language-js">function* generatorFnA() {
  for (const x of [1, 2, 3]) {
    yield x;
  }
}

for (const x of generatorFnA()) {
  console.log(x);
}
// 1
// 2
// 3

function* generatorFnB() {
  yield* [1, 2, 3];
}

for (const x of generatorFnB()) {
  console.log(x);
}
// 1
// 2
// 3
</code></pre>
<p><code>yield*</code>çš„å€¼æ˜¯å…³è”è¿­ä»£å™¨è¿”å›<code>done: true</code>æ—¶çš„<code>value</code>å±æ€§ã€‚å¯¹äºæ™®é€šè¿­ä»£å™¨æ¥è¯´ï¼Œè¿™ä¸ªå€¼æ˜¯<code>undefined</code>ï¼š</p>
<pre><code class="language-js">function* generatorFn() {
  console.log('iter value:', yield* [1, 2, 3]);
}

for (const x of generatorFn()) {
  console.log('value:', x);
}
// value: 1
// value: 2
// value: 3
// iter value: undefined
</code></pre>
<p>å¯¹äºç”Ÿæˆå™¨å‡½æ•°äº§ç”Ÿçš„è¿­ä»£å™¨æ¥è¯´ï¼Œè¿™ä¸ªå€¼å°±æ˜¯ç”Ÿæˆå™¨å‡½æ•°è¿”å›çš„å€¼ï¼š</p>
<pre><code class="language-js">function* innerGeneratorFn() {
  yield 'foo';
  return 'bar';
}
function* outerGeneratorFn(genObj) {
  console.log('iter value:', yield* innerGeneratorFn());
}

for (const x of outerGeneratorFn()) {
  console.log('value:', x);
}
// value: foo
// iter value: bar
</code></pre>
<h4 id="è®©æƒé€šè¿‡yieldå°†æ‰§è¡Œæƒç§»äº¤ç»™å¦ä¸€ä¸ªç”Ÿæˆå™¨">è®©æƒï¼šé€šè¿‡<code>yield*</code>å°†æ‰§è¡Œæƒç§»äº¤ç»™å¦ä¸€ä¸ªç”Ÿæˆå™¨</h4>
<pre><code class="language-js">function* anotherGenerator(i) {
  yield i + 1;
  yield i + 2;
  yield i + 3;
}

function* generator(i){
  yield i;
  yield* anotherGenerator(i);// ç§»äº¤æ‰§è¡Œæƒ
  yield i + 10;
}

var gen = generator(10);

console.log(gen.next().value); // 10
console.log(gen.next().value); // 11
console.log(gen.next().value); // 12
console.log(gen.next().value); // 13
console.log(gen.next().value); // 20
</code></pre>
<h4 id="è¡¥å……">è¡¥å……</h4>
<ol>
<li>
<p><strong><code>yield</code>å…³é”®å­—å¯ä»¥åŒæ—¶ç”¨äºè¾“å…¥å’Œè¾“å‡ºï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</strong></p>
<pre><code class="language-js">// example1
function* generatorFn() {
  return yield 'foo';
}

let generatorObject = generatorFn();

console.log(generatorObject.next());       // { done: false, value: 'foo' }
console.log(generatorObject.next('bar'));  // { done: true, value: 'bar' }

// example2
function *createIterator() {
    let first = yield 1;
    let second = yield first + 2; // 4 + 2
                                  // first =4 æ˜¯next(4)å°†å‚æ•°èµ‹ç»™ä¸Šä¸€æ¡çš„
    yield second + 3;             // 5 + 3
}

let iterator = createIterator();

console.log(iterator.next());    // &quot;{ value: 1, done: false }&quot;
console.log(iterator.next(4));   // &quot;{ value: 6, done: false }&quot;
console.log(iterator.next(5));   // &quot;{ value: 8, done: false }&quot;
console.log(iterator.next());    // &quot;{ value: undefined, done: true }&quot;
</code></pre>
<p>å› ä¸ºå‡½æ•°å¿…é¡»å¯¹æ•´ä¸ªè¡¨è¾¾å¼æ±‚å€¼æ‰èƒ½ç¡®å®šè¦è¿”å›çš„å€¼ï¼Œæ‰€ä»¥å®ƒåœ¨é‡åˆ°<code>yield</code>å…³é”®å­—æ—¶æš‚åœæ‰§è¡Œå¹¶è®¡ç®—å‡ºè¦äº§ç”Ÿçš„å€¼ï¼š<code>&quot;foo&quot;</code>ã€‚ä¸‹ä¸€æ¬¡è°ƒç”¨<code>next()</code>ä¼ å…¥äº†<code>&quot;bar&quot;</code>ï¼Œä½œä¸ºäº¤ç»™åŒä¸€ä¸ª<code>yield</code>çš„å€¼ã€‚ç„¶åè¿™ä¸ªå€¼è¢«ç¡®å®šä¸ºæœ¬æ¬¡ç”Ÿæˆå™¨å‡½æ•°è¦è¿”å›çš„å€¼ã€‚</p>
</li>
<li>
<p><strong>ç”Ÿæˆå™¨å‡½æ•°å†…éƒ¨çš„æ‰§è¡Œæµç¨‹ä¼šé’ˆå¯¹æ¯ä¸ªç”Ÿæˆå™¨å¯¹è±¡åŒºåˆ†ä½œç”¨åŸŸ</strong></p>
<pre><code class="language-js">function* generatorFn() {
  yield 'foo';
  yield 'bar';
  return 'baz';
}

let generatorObject1 = generatorFn();
let generatorObject2 = generatorFn();


console.log(generatorObject1.next()); // { done: false, value: 'foo' }
console.log(generatorObject2.next()); // { done: false, value: 'foo' }
console.log(generatorObject2.next()); // { done: false, value: 'bar' }
console.log(generatorObject1.next()); // { done: false, value: 'bar' }
</code></pre>
</li>
<li>
<p><strong><code>yield</code>å…³é”®å­—åªèƒ½åœ¨ç”Ÿæˆå™¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹ä¼šæŠ›å‡ºé”™è¯¯</strong></p>
<p>ç±»ä¼¼å‡½æ•°çš„<code>return</code>å…³é”®å­—ï¼Œ<code>yield</code>å…³é”®å­—å¿…é¡»ç›´æ¥ä½äºç”Ÿæˆå™¨å‡½æ•°å®šä¹‰ä¸­ï¼Œå‡ºç°åœ¨åµŒå¥—çš„éç”Ÿæˆå™¨å‡½æ•°ä¸­ä¼šæŠ›å‡ºè¯­æ³•é”™è¯¯</p>
<pre><code class="language-js">// æœ‰æ•ˆ
function* validGeneratorFn() {
  yield;
}

// æ— æ•ˆ
function* invalidGeneratorFnA() {
  function a() {
    yield;
  }
}

// æ— æ•ˆ
function* invalidGeneratorFnB() {
  const b = () =&gt; {
    yield;
  }
}

// æ— æ•ˆ
function* invalidGeneratorFnC() {
  (() =&gt; {
    yield;
  })();
}
</code></pre>
</li>
<li>
<p>æ£€æŸ¥æ˜¯å¦å­˜åœ¨é»˜è®¤è¿­ä»£å™¨å±æ€§</p>
<pre><code class="language-js">let num = 1;
let obj = {};

// è¿™ä¸¤ç§ç±»å‹æ²¡æœ‰å®ç°è¿­ä»£å™¨å·¥å‚å‡½æ•°
console.log(num[Symbol.iterator]); // undefined
console.log(obj[Symbol.iterator]); // undefined

let str = 'abc';
let arr = ['a', 'b', 'c'];
let map = new Map().set('a', 1).set('b', 2).set('c', 3);
let set = new Set().add('a').add('b').add('c');
let els = document.querySelectorAll('div');

// è¿™äº›ç±»å‹éƒ½å®ç°äº†è¿­ä»£å™¨å·¥å‚å‡½æ•°
console.log(str[Symbol.iterator]); // f values() { [native code] }
console.log(arr[Symbol.iterator]); // f values() { [native code] }
console.log(map[Symbol.iterator]); // f values() { [native code] }
console.log(set[Symbol.iterator]); // f values() { [native code] }
console.log(els[Symbol.iterator]); // f values() { [native code] }

// è°ƒç”¨è¿™ä¸ªå·¥å‚å‡½æ•°ä¼šç”Ÿæˆä¸€ä¸ªè¿­ä»£å™¨
console.log(str[Symbol.iterator]()); // StringIterator {}
console.log(arr[Symbol.iterator]()); // ArrayIterator {}
console.log(map[Symbol.iterator]()); // MapIterator {}
console.log(set[Symbol.iterator]()); // SetIterator {}
console.log(els[Symbol.iterator]()); // ArrayIterator {}
</code></pre>
</li>
</ol>
<h3 id="æå‰ç»ˆæ­¢ç”Ÿæˆå™¨">æå‰ç»ˆæ­¢ç”Ÿæˆå™¨</h3>
<p>ä¸è¿­ä»£å™¨ç±»ä¼¼ï¼Œç”Ÿæˆå™¨ä¹Ÿæ”¯æŒâ€œå¯å…³é—­â€çš„æ¦‚å¿µã€‚ä¸€ä¸ªå®ç°<code>Iterator</code>æ¥å£çš„å¯¹è±¡ä¸€å®šæœ‰<code>next()</code>æ–¹æ³•ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯é€‰çš„<code>return()</code>æ–¹æ³•ç”¨äºæå‰ç»ˆæ­¢è¿­ä»£å™¨ã€‚ç”Ÿæˆå™¨å¯¹è±¡é™¤äº†æœ‰è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œè¿˜æœ‰ç¬¬ä¸‰ä¸ªæ–¹æ³•ï¼š<code>throw()</code>ã€‚</p>
<pre><code class="language-js">function* generatorFn() {}

const g = generatorFn();

console.log(g);         // generatorFn {&lt;suspended&gt;}
console.log(g.next);    // f next() { [native code] }
console.log(g.return);  // f return() { [native code] }
console.log(g.throw);   // f throw() { [native code] }
</code></pre>
<p><code>return()</code>å’Œ<code>throw()</code>æ–¹æ³•éƒ½å¯ä»¥ç”¨äºå¼ºåˆ¶ç”Ÿæˆå™¨è¿›å…¥å…³é—­çŠ¶æ€ã€‚</p>
<ol>
<li>
<p><strong><code>return()</code></strong></p>
<p><code>return()</code>æ–¹æ³•ä¼šå¼ºåˆ¶ç”Ÿæˆå™¨è¿›å…¥å…³é—­çŠ¶æ€ã€‚æä¾›ç»™<code>return()</code>æ–¹æ³•çš„å€¼ï¼Œå°±æ˜¯ç»ˆæ­¢è¿­ä»£å™¨å¯¹è±¡çš„å€¼ï¼š</p>
<pre><code class="language-js">function* generatorFn() {
  for (const x of [1, 2, 3]) {
    yield x;
  }
}

const g = generatorFn();

console.log(g);            // generatorFn {&lt;suspended&gt;}
console.log(g.return(4));  // { done: true, value: 4 }
console.log(g);            // generatorFn {&lt;closed&gt;}
</code></pre>
<p><strong>ä¸è¿­ä»£å™¨ä¸åŒï¼Œæ‰€æœ‰ç”Ÿæˆå™¨å¯¹è±¡éƒ½æœ‰<code>return()</code>æ–¹æ³•ï¼Œåªè¦é€šè¿‡å®ƒè¿›å…¥å…³é—­çŠ¶æ€ï¼Œå°±æ— æ³•æ¢å¤äº†</strong>ã€‚åç»­è°ƒç”¨<code>next()</code>ä¼šæ˜¾ç¤º<code>done: true</code>çŠ¶æ€ï¼Œè€Œæä¾›çš„ä»»ä½•è¿”å›å€¼éƒ½ä¸ä¼šè¢«å­˜å‚¨æˆ–ä¼ æ’­ï¼š</p>
<pre><code class="language-js">function* generatorFn() {
  for (const x of [1, 2, 3]) {
    yield x;
  }
}

const g = generatorFn();

console.log(g.next());     // { done: false, value: 1 }
console.log(g.return(4));  // { done: true, value: 4 }
console.log(g.next());     // { done: true, value: undefined }
console.log(g.next());     // { done: true, value: undefined }
console.log(g.next());     // { done: true, value: undefined }
</code></pre>
<p><code>for-of</code>å¾ªç¯ç­‰å†…ç½®è¯­è¨€ç»“æ„ä¼šå¿½ç•¥çŠ¶æ€ä¸º<code>done: true</code>çš„<code>IteratorObject</code>å†…éƒ¨è¿”å›çš„å€¼ã€‚</p>
<pre><code class="language-js">function* generatorFn() {
  for (const x of [1, 2, 3]) {
    yield x;
  }
}

const g = generatorFn();

for (const x of g) {
  if (x &gt; 1) {
    g.return(4);
  }
  console.log(x);
}
// 1
// 2
</code></pre>
</li>
<li>
<p><strong><code>throw()</code></strong></p>
<p><code>throw()</code>æ–¹æ³•ä¼šåœ¨æš‚åœçš„æ—¶å€™å°†ä¸€ä¸ªæä¾›çš„é”™è¯¯æ³¨å…¥åˆ°ç”Ÿæˆå™¨å¯¹è±¡ä¸­ã€‚å¦‚æœé”™è¯¯æœªè¢«å¤„ç†ï¼Œç”Ÿæˆå™¨å°±ä¼šå…³é—­ï¼š</p>
<pre><code class="language-js">function* generatorFn() {
  for (const x of [1, 2, 3]) {
    yield x;
  }
}

const g = generatorFn();

console.log(g);   // generatorFn {&lt;suspended&gt;}
try {
  g.throw('foo');
} catch (e) {
  console.log(e); // foo
}
console.log(g);   // generatorFn {&lt;closed&gt;}
</code></pre>
<p>ä¸è¿‡ï¼Œå‡å¦‚ç”Ÿæˆå™¨å‡½æ•°<strong>å†…éƒ¨</strong>å¤„ç†äº†è¿™ä¸ªé”™è¯¯ï¼Œé‚£ä¹ˆç”Ÿæˆå™¨å°±ä¸ä¼šå…³é—­ï¼Œè€Œä¸”è¿˜å¯ä»¥æ¢å¤æ‰§è¡Œã€‚é”™è¯¯å¤„ç†ä¼šè·³è¿‡å¯¹åº”çš„<code>yield</code>ï¼Œå› æ­¤åœ¨è¿™ä¸ªä¾‹å­ä¸­ä¼šè·³è¿‡ä¸€ä¸ªå€¼ã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="language-js">function* generatorFn() {
  for (const x of [1, 2, 3]) {
    try {
      yield x;
    } catch(e) {}
  }
}

const g = generatorFn();

console.log(g.next()); // { done: false, value: 1}
g.throw('foo');
console.log(g.next()); // { done: false, value: 3}
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”Ÿæˆå™¨åœ¨<code>try</code>/<code>catch</code>å—ä¸­çš„<code>yield</code>å…³é”®å­—å¤„æš‚åœæ‰§è¡Œã€‚åœ¨æš‚åœæœŸé—´ï¼Œ<code>throw()</code>æ–¹æ³•å‘ç”Ÿæˆå™¨å¯¹è±¡å†…éƒ¨æ³¨å…¥äº†ä¸€ä¸ªé”™è¯¯ï¼šå­—ç¬¦ä¸²<code>&quot;foo&quot;</code>ã€‚è¿™ä¸ªé”™è¯¯ä¼šè¢«<code>yield</code>å…³é”®å­—æŠ›å‡ºã€‚å› ä¸ºé”™è¯¯æ˜¯åœ¨ç”Ÿæˆå™¨çš„<code>try</code>/<code>catch</code>å—ä¸­æŠ›å‡ºçš„ï¼Œæ‰€ä»¥ä»ç„¶åœ¨ç”Ÿæˆå™¨å†…éƒ¨è¢«æ•è·ã€‚å¯æ˜¯ï¼Œç”±äº<code>yield</code>æŠ›å‡ºäº†é‚£ä¸ªé”™è¯¯ï¼Œç”Ÿæˆå™¨å°±ä¸ä¼šå†äº§å‡ºå€¼<code>2</code>ã€‚æ­¤æ—¶ï¼Œç”Ÿæˆå™¨å‡½æ•°ç»§ç»­æ‰§è¡Œï¼Œåœ¨ä¸‹ä¸€æ¬¡è¿­ä»£å†æ¬¡é‡åˆ°<code>yield</code>å…³é”®å­—æ—¶äº§å‡ºäº†å€¼<code>3</code>ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ã€€å¦‚æœç”Ÿæˆå™¨å¯¹è±¡è¿˜æ²¡æœ‰å¼€å§‹æ‰§è¡Œï¼Œé‚£ä¹ˆè°ƒç”¨<code>throw()</code>æŠ›å‡ºçš„é”™è¯¯ä¸ä¼šåœ¨å‡½æ•°å†…éƒ¨è¢«æ•è·ï¼Œå› ä¸ºè¿™ç›¸å½“äºåœ¨å‡½æ•°å—å¤–éƒ¨æŠ›å‡ºäº†é”™è¯¯ã€‚</p>
</blockquote>
</li>
</ol>
<h2 id="how-2">How</h2>
<h3 id="å®è·µ">å®è·µ</h3>
<h4 id="ç”Ÿæˆå™¨å¯¹è±¡ä½œä¸ºå¯è¿­ä»£å¯¹è±¡"><strong>ç”Ÿæˆå™¨å¯¹è±¡ä½œä¸ºå¯è¿­ä»£å¯¹è±¡</strong></h4>
<p>åœ¨ç”Ÿæˆå™¨å¯¹è±¡ä¸Šæ˜¾å¼è°ƒç”¨<code>next()</code>æ–¹æ³•çš„ç”¨å¤„å¹¶ä¸å¤§ã€‚å…¶å®ï¼Œå¦‚æœæŠŠç”Ÿæˆå™¨å¯¹è±¡å½“æˆå¯è¿­ä»£å¯¹è±¡ï¼Œé‚£ä¹ˆä½¿ç”¨èµ·æ¥ä¼šæ›´æ–¹ä¾¿ï¼š</p>
<pre><code class="language-js">function* generatorFn() {
  yield 1;
  yield 2;
  yield 3;
}

for (const x of generatorFn()) {
  console.log(x);
}
// 1
// 2
// 3
</code></pre>
<h4 id="ä½¿ç”¨yieldå®ç°é€’å½’ç®—æ³•"><strong>ä½¿ç”¨<code>yield*</code>å®ç°é€’å½’ç®—æ³•</strong></h4>
<p><code>yield*</code>æœ€æœ‰ç”¨çš„åœ°æ–¹æ˜¯å®ç°é€’å½’æ“ä½œï¼Œæ­¤æ—¶ç”Ÿæˆå™¨å¯ä»¥äº§ç”Ÿè‡ªèº«ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<pre><code class="language-js">function* nTimes(n) {
  if (n &gt; 0) {
    yield* nTimes(n - 1);
    yield n - 1;
  }
}

for (const x of nTimes(3)) {
  console.log(x);
}
// 0
// 1
// 2

</code></pre>
<h3 id="åº”ç”¨">åº”ç”¨</h3>
<h4 id="ç”Ÿæˆå™¨ä½œä¸ºé»˜è®¤è¿­ä»£å™¨">ç”Ÿæˆå™¨ä½œä¸ºé»˜è®¤è¿­ä»£å™¨</h4>
<p>å› ä¸ºç”Ÿæˆå™¨å¯¹è±¡å®ç°äº†<code>Iterable</code>æ¥å£ï¼Œè€Œä¸”ç”Ÿæˆå™¨å‡½æ•°å’Œé»˜è®¤è¿­ä»£å™¨è¢«è°ƒç”¨ä¹‹åéƒ½äº§ç”Ÿè¿­ä»£å™¨ï¼Œæ‰€ä»¥ç”Ÿæˆå™¨æ ¼å¤–é€‚åˆä½œä¸ºé»˜è®¤è¿­ä»£å™¨ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¿™ä¸ªç±»çš„é»˜è®¤è¿­ä»£å™¨å¯ä»¥ç”¨ä¸€è¡Œä»£ç äº§å‡ºç±»çš„å†…å®¹ï¼š</p>
<pre><code class="language-js">class Foo {
  constructor() {
    this.values = [1, 2, 3];
  }
  * [Symbol.iterator]() {
    yield* this.values;
  }
}

const f = new Foo();
for (const x of f) {
  console.log(x);
}
// 1
// 2
// 3
</code></pre>
<p>è¿™é‡Œï¼Œ<code>for-of</code>å¾ªç¯è°ƒç”¨äº†é»˜è®¤è¿­ä»£å™¨ï¼ˆå®ƒæ°å¥½åˆæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ï¼‰å¹¶äº§ç”Ÿäº†ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ã€‚è¿™ä¸ªç”Ÿæˆå™¨å¯¹è±¡æ˜¯å¯è¿­ä»£çš„ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥åœ¨è¿­ä»£ä¸­ä½¿ç”¨ã€‚</p>
<h4 id="æ— ç©·è®¡æ•°ç”Ÿæˆå™¨å‡½æ•°">æ— ç©·è®¡æ•°ç”Ÿæˆå™¨å‡½æ•°</h4>
<pre><code class="language-js">function* generatorFn() {
  for (let i = 0;;++i) {
    yield i;
  }
}

let generatorObject = generatorFn();

console.log(generatorObject.next().value);  // 0
console.log(generatorObject.next().value);  // 1
console.log(generatorObject.next().value);  // 2
console.log(generatorObject.next().value);  // 3
console.log(generatorObject.next().value);  // 4
console.log(generatorObject.next().value);  // 5
</code></pre>
<h4 id="å®ç°èŒƒå›´å’Œå¡«å……æ•°ç»„">å®ç°èŒƒå›´å’Œå¡«å……æ•°ç»„</h4>
<pre><code class="language-js">function* range(start, end) {
  while(end &gt; start) {
    yield start++;
  }
}

for (const x of range(4, 7)) {
  console.log(x);
}
// 4
// 5
// 6

function* zeroes(n) {
  while(n--) {
    yield 0;
  }
}

console.log(Array.from(zeroes(8))); // [0, 0, 0, 0, 0, 0, 0, 0]
</code></pre>
<h4 id="é€’å½’éå†å›¾">é€’å½’éå†å›¾</h4>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯ä¸ªç”Ÿæˆå™¨é¦–å…ˆéƒ½ä¼šä»æ–°åˆ›å»ºçš„ç”Ÿæˆå™¨å¯¹è±¡äº§å‡ºæ¯ä¸ªå€¼ï¼Œç„¶åå†äº§å‡ºä¸€ä¸ªæ•´æ•°ã€‚ç»“æœå°±æ˜¯ç”Ÿæˆå™¨å‡½æ•°ä¼šé€’å½’åœ°å‡å°‘è®¡æ•°å™¨å€¼ï¼Œå¹¶å®ä¾‹åŒ–å¦ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ã€‚ä»æœ€é¡¶å±‚æ¥çœ‹ï¼Œè¿™å°±ç›¸å½“äºåˆ›å»ºä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡å¹¶è¿”å›é€’å¢çš„æ•´æ•°ã€‚</p>
<p>ä½¿ç”¨é€’å½’ç”Ÿæˆå™¨ç»“æ„å’Œ<code>yield*</code>å¯ä»¥ä¼˜é›…åœ°è¡¨è¾¾é€’å½’ç®—æ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå›¾çš„å®ç°ï¼Œç”¨äºç”Ÿæˆä¸€ä¸ªéšæœºçš„åŒå‘å›¾ï¼š</p>
<pre><code class="language-js">class Node {
  constructor(id) {
    this.id = id;
    this.neighbors = new Set();
  }

  connect(node) {
    if (node !== this) {
      this.neighbors.add(node);
      node.neighbors.add(this);
    }
  }
}

class RandomGraph {
  constructor(size) {
    this.nodes = new Set();

    // åˆ›å»ºèŠ‚ç‚¹
    for (let i = 0; i &lt; size; ++i) {
      this.nodes.add(new Node(i));
    }

    // éšæœºè¿æ¥èŠ‚ç‚¹
    const threshold = 1 / size;
    for (const x of this.nodes) {
      for (const y of this.nodes) {
        if (Math.random() &lt; threshold) {
          x.connect(y);
        }
      }
    }
  }

  // è¿™ä¸ªæ–¹æ³•ä»…ç”¨äºè°ƒè¯•
  print() {
    for (const node of this.nodes) {
      const ids = [...node.neighbors]
                      .map((n) =&gt; n.id)
                      .join(',');

      console.log(`${node.id}: ${ids}`);
    }
  }
}

const g = new RandomGraph(6);

g.print();
// ç¤ºä¾‹è¾“å‡ºï¼š
// 0: 2,3,5
// 1: 2,3,4,5
// 2: 1,3
// 3: 0,1,2,4
// 4: 2,3
// 5: 0,4
</code></pre>
<p>å›¾æ•°æ®ç»“æ„éå¸¸é€‚åˆé€’å½’éå†ï¼Œè€Œé€’å½’ç”Ÿæˆå™¨æ°å¥½éå¸¸åˆç”¨ã€‚ä¸ºæ­¤ï¼Œç”Ÿæˆå™¨å‡½æ•°å¿…é¡»æ¥æ”¶ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œäº§å‡ºè¯¥å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå€¼ï¼Œå¹¶ä¸”å¯¹æ¯ä¸ªå€¼è¿›è¡Œé€’å½’ã€‚è¿™ä¸ªå®ç°å¯ä»¥ç”¨æ¥æµ‹è¯•æŸä¸ªå›¾æ˜¯å¦è¿é€šï¼Œå³æ˜¯å¦æ²¡æœ‰ä¸å¯åˆ°è¾¾çš„èŠ‚ç‚¹ã€‚åªè¦ä»ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œç„¶åå°½åŠ›è®¿é—®æ¯ä¸ªèŠ‚ç‚¹å°±å¯ä»¥äº†ã€‚ç»“æœå°±å¾—åˆ°äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ·±åº¦ä¼˜å…ˆéå†ï¼š</p>
<pre><code class="language-js">class Node {
  constructor(id) {
    ...
  }

  connect(node) {
    ...
  }
}

class RandomGraph {
  constructor(size) {
    ...
  }

  print() {
    ...
  }

  isConnected() {
    const visitedNodes = new Set();

    function* traverse(nodes) {
      for (const node of nodes) {
        if (!visitedNodes.has(node)) {
          yield node;
          yield* traverse(node.neighbors);
        }
      }
    }

    // å–å¾—é›†åˆä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
    const firstNode = this.nodes[Symbol.iterator]().next().value;

    // ä½¿ç”¨é€’å½’ç”Ÿæˆå™¨è¿­ä»£æ¯ä¸ªèŠ‚ç‚¹
    for (const node of traverse([firstNode])) {
      visitedNodes.add(node);
    }

    return visitedNodes.size === this.nodes.size;
  }
}
</code></pre>
<h4 id="ä½¿ç”¨è¿­ä»£å™¨éå†äºŒç»´æ•°ç»„å¹¶è½¬æ¢æˆä¸€ç»´æ•°ç»„">ä½¿ç”¨è¿­ä»£å™¨éå†äºŒç»´æ•°ç»„å¹¶è½¬æ¢æˆä¸€ç»´æ•°ç»„</h4>
<pre><code class="language-js">function* iterArr(arr) {            //è¿­ä»£å™¨è¿”å›ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡
  if (Array.isArray(arr)) {         // å†…èŠ‚ç‚¹
      for(let i=0; i &lt; arr.length; i++) {
          yield* iterArr(arr[i]);   // (*)é€’å½’
      }
  } else {                          // ç¦»å¼€
      yield arr;
  }
}
// ä½¿ç”¨ for-of éå†:
var arr = ['a', ['b', 'c'], ['d', 'e']];
for(var x of iterArr(arr)) {
        console.log(x);               // a  b  c  d  e
 }

// æˆ–è€…ç›´æ¥å°†è¿­ä»£å™¨å±•å¼€:
var arr = [ 'a', ['b',[ 'c', ['d', 'e']]]];
var gen = iterArr(arr);
arr = [...gen];                        // [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]
</code></pre>
<h1 id="å­¦ä¹ èµ„æ–™">å­¦ä¹ èµ„æ–™</h1>
<ul>
<li>ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ï¼ˆç¬¬4ç‰ˆï¼‰ã€‹</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols">è¿­ä»£åè®®</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Generator">Generator</a></li>
</ul>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://blog.ikozn.com/tag/Uk35PYx0o/" class="tag">
                    javascript
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://blog.ikozn.com/post/æœ¬åšå®¢æœç´¢åä»£ä¸Šçº¿/">
                  <h3 class="post-title">
                    æœ¬åšå®¢æœç´¢åä»£ä¸Šçº¿
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '0db2ec692e695c68b01b',
        clientSecret: '3db8da412bbe1c349309420810429c6121a95249',
        repo: 'blog-comments',
        owner: 'ikozn',
        admin: ['ikozn'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
